"use strict";(self.webpackChunkngTodo=self.webpackChunkngTodo||[]).push([[838],{2838:(R,g,r)=>{r.r(g),r.d(g,{TodosModule:()=>H});var p=r(6895),f=r(7487),e=r(8256),v=r(1135),C=r(515),l=r(262),u=r(4004),c=r(2340),y=r(529),_=r(7650);let $=(()=>{class s{constructor(t,o){this.http=t,this.beatyLoggerService=o,this.todos$=new v.X([])}errorHandler(t){return this.beatyLoggerService.log(t.message,"error"),C.E}getTodosLength(){return this.todos$.getValue().length}getTodos(){this.http.get(`${c.N.baseURL}/todo-lists`).pipe((0,l.K)(this.errorHandler.bind(this))).subscribe(t=>{this.todos$.next(t)})}createTodos(t){this.http.post(`${c.N.baseURL}/todo-lists`,{title:t}).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(o=>{const n=o.data.item;return[...this.todos$.getValue(),n]})).subscribe(o=>{this.todos$.next(o)})}deleteTodos(t){return this.http.delete(`${c.N.baseURL}/todo-lists/${t}`).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(()=>this.todos$.getValue().filter(o=>o.id!==t))).subscribe(o=>{this.todos$.next(o)})}updateTodosTitle(t,o){return this.http.put(`${c.N.baseURL}/todo-lists/${t}`,{title:o}).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(()=>this.todos$.getValue().map(n=>n.id===t?{...n,title:o}:n))).subscribe(n=>{this.todos$.next(n)})}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(y.eN),e.LFG(_.u))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac,providedIn:"root"}),s})();var h=r(433);let b=(()=>{class s{constructor(){this.placeholder="",this.item=new h.NI(""),this.addItem=new e.vpe}addItemHandler(){const t=this.item.value?.trim();t&&(this.addItem.emit(t),this.item.setValue(""))}ngOnInit(){}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["tdl-add-item"]],inputs:{placeholder:"placeholder"},outputs:{addItem:"addItem"},decls:3,vars:2,consts:[["type","text",3,"placeholder","formControl","keyup.enter"],[3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"input",0),e.NdJ("keyup.enter",function(){return o.addItemHandler()}),e.qZA(),e.TgZ(1,"button",1),e.NdJ("click",function(){return o.addItemHandler()}),e._uU(2,"add"),e.qZA()),2&t&&e.Q6J("placeholder",o.placeholder)("formControl",o.item)},dependencies:[h.Fj,h.JJ,h.oH]}),s})();var x=r(8877);let k=(()=>{class s{constructor(t,o){this.http=t,this.beatyLoggerService=o,this.tasks$=new v.X({})}errorHandler(t){return this.beatyLoggerService.log(t.message,"error"),C.E}getTasks(t){this.http.get(`${c.N.baseURL}/todo-lists/${t}/tasks`).pipe((0,l.K)(this.errorHandler.bind(this))).subscribe(o=>{this.tasks$.next({...this.tasks$.getValue(),[t]:o.items})})}createTask(t,o){this.http.post(`${c.N.baseURL}/todo-lists/${t}/tasks`,{title:o}).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(n=>{const a=n.data.item,d=this.tasks$.getValue();return d[t].unshift(a),d})).subscribe(n=>{this.tasks$.next(n)})}deleteTask(t,o){return this.http.delete(`${c.N.baseURL}/todo-lists/${t}/tasks/${o}`).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(()=>{const n=this.tasks$.getValue();return n[t]=n[t].filter(a=>a.id!==o),n})).subscribe(n=>{this.tasks$.next(n)})}updateTaskTitle(t,o,n){const a=this.tasks$.getValue()[t].find(T=>T.id===o),d={...this._createUpdateTaskModel(a,"title",n)};return this._updateTask(t,o,d)}updateTaskStatus(t,o,n){const a=this.tasks$.getValue()[t].find(T=>T.id===o),d={...this._createUpdateTaskModel(a,"status",n)};return this._updateTask(t,o,d)}_updateTask(t,o,n){const a=this.tasks$.getValue();return this.http.put(`${c.N.baseURL}/todo-lists/${t}/tasks/${o}`,n).pipe((0,l.K)(this.errorHandler.bind(this)),(0,u.U)(d=>a[t].map(T=>T.id===o?d.data.item:T))).subscribe(d=>{this.tasks$.next({...a,[t]:[...d]})})}_createUpdateTaskModel(t={},o,n){return{title:t.title,status:t.status,deadline:t.deadline,description:t.description,priority:t.priority,startDate:t.startDate,[o]:n}}createUpdateTaskModel(t={}){return{title:t.title&&" ",status:t.status,deadline:t.deadline,description:t.description,priority:t.priority,startDate:t.startDate}}}return s.\u0275fac=function(t){return new(t||s)(e.LFG(y.eN),e.LFG(_.u))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})();var m=(()=>{return(s=m||(m={}))[s.New=0]="New",s[s.InProgress=1]="InProgress",s[s.Complited=2]="Complited",s[s.Draft=3]="Draft",m;var s})();let w=(()=>{class s{constructor(t){this.tasksService=t,this.taskComplited=!1}deleteTask(){this.tasksService.deleteTask(this.task.todoListId,this.task.id)}changeTaskTitle(t){this.tasksService.updateTaskTitle(this.task.todoListId,this.task.id,t)}changeTaskStatus(){event?.preventDefault();const t=this.task.status===m.New?m.Complited:m.New;console.log("change status"),this.tasksService.updateTaskStatus(this.task.todoListId,this.task.id,t)}ngOnInit(){this.taskComplited=this.task.status===m.Complited}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(k))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tdl-task"]],inputs:{task:"task"},decls:5,vars:4,consts:[["type","checkbox",3,"checked","click"],[3,"name","changeName"],[3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"input",0),e.NdJ("click",function(){return o.changeTaskStatus()}),e.qZA(),e.TgZ(1,"tdl-editable-name",1),e.NdJ("changeName",function(a){return o.changeTaskTitle(a)}),e.qZA(),e._uU(2),e.TgZ(3,"button",2),e.NdJ("click",function(){return o.deleteTask()}),e._uU(4,"x"),e.qZA()),2&t&&(e.Q6J("checked",o.taskComplited),e.xp6(1),e.Q6J("name",o.task.title),e.xp6(1),e.AsE("\n",o.task.completed,"\n",o.task.order,"\n"))},dependencies:[x.p]}),s})();function S(s,i){if(1&s&&(e.TgZ(0,"div",3),e._UZ(1,"tdl-task",4),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("task",t)}}let I=(()=>{class s{constructor(t){this.tasksService=t,this.tasks$=this.tasksService.tasks$,this.tasksById$=this.tasksService.tasks$.pipe((0,u.U)(o=>o[this.todoId]))}changeTaskTitle(t,o){this.tasksService.updateTaskTitle(this.todoId,o,t)}deleteTask(t){this.tasksService.deleteTask(this.todoId,t)}createNewTask(t){this.tasksService.createTask(this.todoId,t)}ngOnInit(){this.tasksService.getTasks(this.todoId),console.log("task")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(k))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tdl-tasks"]],inputs:{todoId:"todoId"},decls:4,vars:3,consts:[[1,"taskContainer"],["placeholder","add task name",3,"addItem"],["class","task",4,"ngFor","ngForOf"],[1,"task"],[3,"task"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"tdl-add-item",1),e.NdJ("addItem",function(a){return o.createNewTask(a)}),e.qZA(),e.YNc(2,S,2,1,"div",2),e.ALo(3,"async"),e.qZA()),2&t&&(e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,o.tasksById$)))},dependencies:[p.sg,b,w,p.Ov],styles:[".taskContainer[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap;background-color:#afcbe6;margin-top:20px}.task[_ngcontent-%COMP%]{margin-top:5px}"]}),s})(),Z=(()=>{class s{constructor(t){this.todosService=t,this.newTitle=""}getNewTitle(t){this.newTitle=t,this.updateTodosTitle()}deleteTodo(){this.todosService.deleteTodos(this.todo.id)}updateTodosTitle(){console.log("update title"),this.todosService.updateTodosTitle(this.todo.id,this.newTitle)}ngOnInit(){console.log("td")}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tdl-todo"]],inputs:{todo:"todo"},decls:5,vars:2,consts:[[1,"title"],[3,"name","changeName"],[1,"buttonDel",3,"click"],[3,"todoId"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"tdl-editable-name",1),e.NdJ("changeName",function(a){return o.getNewTitle(a)}),e.qZA(),e.TgZ(2,"button",2),e.NdJ("click",function(){return o.deleteTodo()}),e._uU(3,"x"),e.qZA()(),e._UZ(4,"tdl-tasks",3)),2&t&&(e.xp6(1),e.Q6J("name",o.todo.title),e.xp6(3),e.Q6J("todoId",o.todo.id))},dependencies:[x.p,I],styles:[".title[_ngcontent-%COMP%]{margin-left:10px;font-size:24px;font-weight:500;display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.buttonDel[_ngcontent-%COMP%]{margin-left:10px;font-size:9px;padding:5px}"]}),s})();function U(s,i){if(1&s&&(e.TgZ(0,"h1"),e._uU(1),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Oqu(t.error)}}function A(s,i){if(1&s&&(e.TgZ(0,"div",5),e._UZ(1,"tdl-todo",6),e.qZA()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("todo",t)}}function L(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tdl-add-item",2),e.NdJ("addItem",function(n){e.CHM(t);const a=e.oxw();return e.KtG(a.createTodosHandler(n))}),e.qZA(),e.TgZ(1,"div",3),e.YNc(2,A,2,1,"div",4),e.ALo(3,"async"),e.qZA()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("ngForOf",e.lcZ(3,1,t.todos$))}}const P=[{path:"",component:(()=>{class s{constructor(t){this.todosService=t,this.error="",this.todos$=this.todosService.todos$}createTodosHandler(t){this.todosService.getTodosLength()<10?(console.log(this.todosService.getTodosLength()),console.log("create TODO with title: "+t),this.todosService.createTodos(t)):(this.error="too many Todos",setTimeout(()=>{this.error=""},1e3))}getTodos(){this.todosService.getTodos()}ngOnInit(){console.log("start todos"),this.getTodos()}}return s.\u0275fac=function(t){return new(t||s)(e.Y36($))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tdl-todos"]],decls:3,vars:2,consts:[[4,"ngIf","ngIfElse"],["content",""],["placeholder","create new ToDo",3,"addItem"],[1,"todos"],["class","todo",4,"ngFor","ngForOf"],[1,"todo"],[3,"todo"]],template:function(t,o){if(1&t&&(e.YNc(0,U,2,1,"h1",0),e.YNc(1,L,4,3,"ng-template",null,1,e.W1O)),2&t){const n=e.MAs(2);e.Q6J("ngIf",!!o.error)("ngIfElse",n)}},dependencies:[p.sg,p.O5,b,Z,p.Ov],styles:[".todos[_ngcontent-%COMP%]{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:left;align-items:flex-start}.todo[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex-wrap:nowrap;border:solid 2px rgba(0,0,0,.29);margin:10px 10px 10px 0;padding:15px;background-color:#c6d7ea}"]}),s})(),canActivate:[r(7574).a]}];let F=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[f.Bz.forChild(P),f.Bz]}),s})();var N=r(4466);let O=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({providers:[k],imports:[p.ez,N.m]}),s})(),H=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[p.ez,F,N.m,O]}),s})()}}]);